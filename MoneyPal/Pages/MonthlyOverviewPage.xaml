<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:MoneyPal.Pages"
             x:Class="MoneyPal.Pages.MonthlyOverviewPage"
             Title="Maandoverzicht">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Modern Card Style with subtle shadow -->
            <Style x:Key="ModernCard" TargetType="Frame">
                <Setter Property="BackgroundColor" Value="{StaticResource Surface}" />
                <Setter Property="BorderColor" Value="Transparent" />
                <Setter Property="CornerRadius" Value="16" />
                <Setter Property="HasShadow" Value="True" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="Margin" Value="0" />
            </Style>

            <!-- Gradient Card for Summary -->
            <Style x:Key="GradientCard" TargetType="Frame">
                <Setter Property="BorderColor" Value="Transparent" />
                <Setter Property="CornerRadius" Value="16" />
                <Setter Property="HasShadow" Value="True" />
                <Setter Property="Padding" Value="0" />
                <Setter Property="Margin" Value="0" />
            </Style>

            <!-- Icon Container -->
            <Style x:Key="IconFrame" TargetType="Frame">
                <Setter Property="Padding" Value="0" />
                <Setter Property="CornerRadius" Value="14" />
                <Setter Property="BorderColor" Value="Transparent" />
                <Setter Property="HasShadow" Value="False" />
                <Setter Property="WidthRequest" Value="56" />
                <Setter Property="HeightRequest" Value="56" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,*" RowSpacing="0">

        <!-- Modern Header with Gradient Background -->
        <Grid Grid.Row="0" Padding="20,20,20,16" BackgroundColor="{StaticResource Surface}">
            <Grid.Shadow>
                <Shadow Brush="{StaticResource Background}"
                        Opacity="0.3"
                        Radius="8"
                        Offset="0,2" />
            </Grid.Shadow>

            <!-- Month Navigation -->
            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                <Border Grid.Column="0"
                        BackgroundColor="{StaticResource Primary}"
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 25">
                    <Border.Shadow>
                        <Shadow Brush="{StaticResource Primary}"
                                Opacity="0.4"
                                Radius="10"
                                Offset="0,4" />
                    </Border.Shadow>
                    <Button Text="â—€"
                            TextColor="White"
                            BackgroundColor="Transparent"
                            FontSize="18"
                            FontAttributes="Bold"
                            Clicked="OnPreviousMonthClicked"
                            WidthRequest="50"
                            HeightRequest="50"
                            Padding="0" />
                </Border>

                <Border Grid.Column="1"
                        BackgroundColor="{StaticResource Surface}"
                        Stroke="{StaticResource Border}"
                        StrokeThickness="1"
                        StrokeShape="RoundRectangle 14"
                        Padding="16,12"
                        VerticalOptions="Center">
                    <Label x:Name="MonthLabel"
                           TextColor="{StaticResource TextPrimary}"
                           FontSize="17"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                </Border>

                <Border Grid.Column="2"
                        BackgroundColor="{StaticResource Primary}"
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 25">
                    <Border.Shadow>
                        <Shadow Brush="{StaticResource Primary}"
                                Opacity="0.4"
                                Radius="10"
                                Offset="0,4" />
                    </Border.Shadow>
                    <Button Text="â–¶"
                            TextColor="White"
                            BackgroundColor="Transparent"
                            FontSize="18"
                            FontAttributes="Bold"
                            Clicked="OnNextMonthClicked"
                            WidthRequest="50"
                            HeightRequest="50"
                            Padding="0" />
                </Border>
            </Grid>
        </Grid>

        <!-- Content -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="15" Padding="20,0,20,20">

                <!-- Summary Cards - Modern 2 Column Grid Layout -->
                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="12" RowSpacing="12" Margin="0,20,0,0">

                    <!-- Row 0, Column 0: Total Expenses -->
                    <Border Grid.Row="0" Grid.Column="0"
                            BackgroundColor="{StaticResource Surface}"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 16"
                            Padding="16,14">
                        <Border.Shadow>
                            <Shadow Brush="Black" Opacity="0.15" Radius="8" Offset="0,2" />
                        </Border.Shadow>
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Totale lasten"
                                   TextColor="{StaticResource TextSecondary}"
                                   FontSize="12"
                                   Opacity="0.8" />
                            <Label x:Name="TotalLabel"
                                   Text="â‚¬ 0"
                                   TextColor="{StaticResource Primary}"
                                   FontSize="20"
                                   FontAttributes="Bold" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Row 0, Column 1: Spent -->
                    <Border Grid.Row="0" Grid.Column="1"
                            BackgroundColor="{StaticResource Surface}"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 16"
                            Padding="16,14">
                        <Border.Shadow>
                            <Shadow Brush="Black" Opacity="0.15" Radius="8" Offset="0,2" />
                        </Border.Shadow>
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Uitgegeven"
                                   TextColor="{StaticResource TextSecondary}"
                                   FontSize="12"
                                   Opacity="0.8" />
                            <Label x:Name="PaidLabel"
                                   Text="â‚¬ 0"
                                   TextColor="{StaticResource Warning}"
                                   FontSize="20"
                                   FontAttributes="Bold" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Row 1, Column 0: To Pay -->
                    <Border Grid.Row="1" Grid.Column="0"
                            BackgroundColor="{StaticResource Surface}"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 16"
                            Padding="16,14">
                        <Border.Shadow>
                            <Shadow Brush="Black" Opacity="0.15" Radius="8" Offset="0,2" />
                        </Border.Shadow>
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Te betalen"
                                   TextColor="{StaticResource TextSecondary}"
                                   FontSize="12"
                                   Opacity="0.8" />
                            <Label x:Name="UnpaidLabel"
                                   Text="â‚¬ 0"
                                   TextColor="{StaticResource Error}"
                                   FontSize="20"
                                   FontAttributes="Bold" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Row 1, Column 1: Current Bank Balance with Edit Button -->
                    <Border Grid.Row="1" Grid.Column="1"
                            BackgroundColor="{StaticResource Surface}"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 16"
                            Padding="16,14">
                        <Border.Shadow>
                            <Shadow Brush="Black" Opacity="0.15" Radius="8" Offset="0,2" />
                        </Border.Shadow>
                        <Grid RowDefinitions="Auto,Auto">
                            <HorizontalStackLayout Grid.Row="0" Spacing="6">
                                <Label Text="Banksaldo"
                                       TextColor="{StaticResource TextSecondary}"
                                       FontSize="12"
                                       Opacity="0.8"
                                       VerticalOptions="Center" />
                                <Border BackgroundColor="{StaticResource Primary}"
                                        StrokeThickness="0"
                                        StrokeShape="RoundRectangle 6"
                                        Padding="6,4"
                                        VerticalOptions="Center">
                                    <Button Text="âœï¸"
                                            BackgroundColor="Transparent"
                                            TextColor="White"
                                            FontSize="12"
                                            Padding="0"
                                            Margin="0"
                                            WidthRequest="20"
                                            HeightRequest="20"
                                            VerticalOptions="Center"
                                            Clicked="OnEditBankBalanceClicked" />
                                </Border>
                            </HorizontalStackLayout>
                            <Label Grid.Row="1"
                                   x:Name="BankBalanceLabel"
                                   Text="â‚¬ 0"
                                   TextColor="{StaticResource Success}"
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   Margin="0,6,0,0" />
                        </Grid>
                    </Border>

                    <!-- Row 2, Column 0-1 (Full Width): Remaining After Payments - Gradient Card -->
                    <Border Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                            BackgroundColor="{StaticResource Primary}"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 18"
                            Padding="20,16">
                        <Border.Shadow>
                            <Shadow Brush="{StaticResource Primary}" Opacity="0.35" Radius="12" Offset="0,4" />
                        </Border.Shadow>
                        <Grid ColumnDefinitions="*,Auto">
                            <VerticalStackLayout Grid.Column="0" Spacing="4" VerticalOptions="Center">
                                <Label Text="Resterend na betalingen"
                                       TextColor="White"
                                       FontSize="13"
                                       Opacity="0.9" />
                                <Label Text="Banksaldo - Te betalen"
                                       TextColor="White"
                                       FontSize="11"
                                       Opacity="0.7" />
                            </VerticalStackLayout>
                            <Label Grid.Column="1"
                                   x:Name="RemainingAfterPaymentsLabel"
                                   Text="â‚¬ 0"
                                   TextColor="White"
                                   FontSize="24"
                                   FontAttributes="Bold"
                                   HorizontalOptions="End"
                                   VerticalOptions="Center" />
                        </Grid>
                    </Border>
                </Grid>

                <!-- Empty State -->
                <VerticalStackLayout x:Name="EmptyState" IsVisible="False" Spacing="20" Padding="40" HorizontalOptions="Center" VerticalOptions="Center">
                    <Label Text="ðŸ’°" FontSize="64" HorizontalOptions="Center" />
                    <Label Text="Geen data"
                           TextColor="{StaticResource TextPrimary}"
                           FontSize="20"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                    <Label Text="Maak budgetten en uitgaven aan om je financiÃ«n te tracken"
                           TextColor="{StaticResource TextSecondary}"
                           FontSize="14"
                           HorizontalOptions="Center"
                           HorizontalTextAlignment="Center" />
                </VerticalStackLayout>

                <!-- Budgets Section -->
                <VerticalStackLayout x:Name="BudgetsSection" IsVisible="False" Spacing="12" Margin="0,24,0,0">
                    <HorizontalStackLayout Spacing="8" Margin="4,0,0,8">
                        <Label Text="ðŸ’°"
                               FontSize="24"
                               VerticalOptions="Center" />
                        <Label Text="Budgetten"
                               TextColor="{StaticResource TextPrimary}"
                               FontSize="22"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <CollectionView x:Name="BudgetsCollection" SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="local:MonthlyBudgetItem">
                            <Border BackgroundColor="{StaticResource Surface}"
                                    StrokeThickness="0"
                                    StrokeShape="RoundRectangle 18"
                                    Padding="18"
                                    Margin="0,0,0,12">
                                <Border.Shadow>
                                    <Shadow Brush="Black" Opacity="0.15" Radius="10" Offset="0,3" />
                                </Border.Shadow>
                                <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="16" RowSpacing="12">

                                    <!-- Icon with Gradient Background -->
                                    <Border Grid.Row="0" Grid.Column="0" Grid.RowSpan="3"
                                            BackgroundColor="{StaticResource Success}"
                                            StrokeThickness="0"
                                            StrokeShape="RoundRectangle 16"
                                            Padding="0"
                                            WidthRequest="64"
                                            HeightRequest="64"
                                            VerticalOptions="Start">
                                        <Border.Shadow>
                                            <Shadow Brush="{StaticResource Success}" Opacity="0.3" Radius="8" Offset="0,2" />
                                        </Border.Shadow>
                                        <Label Text="ðŸ’°"
                                               FontSize="32"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center" />
                                    </Border>

                                    <!-- Header: Name and Details Button -->
                                    <Grid Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                        <Label Grid.Column="0"
                                               Text="{Binding Name}"
                                               TextColor="{StaticResource TextPrimary}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               VerticalOptions="Center"
                                               LineBreakMode="TailTruncation" />

                                        <Border Grid.Column="1"
                                                BackgroundColor="{StaticResource Primary}"
                                                StrokeThickness="0"
                                                StrokeShape="RoundRectangle 10"
                                                Padding="10"
                                                VerticalOptions="Center">
                                            <Border.GestureRecognizers>
                                                <TapGestureRecognizer Tapped="OnViewBudgetDetailsClicked" CommandParameter="{Binding .}" />
                                            </Border.GestureRecognizers>
                                            <Label Text="ðŸ”"
                                                   FontSize="18"
                                                   VerticalOptions="Center"
                                                   HorizontalOptions="Center" />
                                        </Border>
                                    </Grid>

                                    <!-- Budget Amount Info -->
                                    <Grid Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" ColumnDefinitions="Auto,Auto,Auto" ColumnSpacing="10">
                                        <Label Grid.Column="0"
                                               Text="{Binding SpentAmount, StringFormat='â‚¬ {0:N2}'}"
                                               TextColor="{StaticResource Warning}"
                                               FontSize="16"
                                               FontAttributes="Bold"
                                               VerticalOptions="Center" />

                                        <Label Grid.Column="1"
                                               Text="van"
                                               TextColor="{StaticResource TextSecondary}"
                                               FontSize="14"
                                               VerticalOptions="Center"
                                               Margin="0,2,0,0" />

                                        <Label Grid.Column="2"
                                               Text="{Binding BudgetAmount, StringFormat='â‚¬ {0:N2}'}"
                                               TextColor="{StaticResource Primary}"
                                               FontSize="16"
                                               FontAttributes="Bold"
                                               VerticalOptions="Center" />
                                    </Grid>

                                    <!-- Modern Progress Bar -->
                                    <ProgressBar Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2"
                                                 Progress="{Binding ProgressPercentage}"
                                                 ProgressColor="{StaticResource Primary}"
                                                 HeightRequest="10" />

                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                </VerticalStackLayout>

                <!-- Recurring Expenses Section -->
                <VerticalStackLayout x:Name="RecurringExpensesSection" IsVisible="False" Spacing="12" Margin="0,24,0,0">
                    <HorizontalStackLayout Spacing="8" Margin="4,0,0,8">
                        <Label Text="ðŸ’³"
                               FontSize="24"
                               VerticalOptions="Center" />
                        <Label Text="Terugkerende Uitgaven"
                               TextColor="{StaticResource TextPrimary}"
                               FontSize="22"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <CollectionView x:Name="ExpensesCollection" SelectionMode="None">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="local:MonthlyExpenseItem">
                                <Border BackgroundColor="{StaticResource Surface}"
                                        StrokeThickness="0"
                                        StrokeShape="RoundRectangle 18"
                                        Padding="18"
                                        Margin="0,0,0,12">
                                    <Border.Shadow>
                                        <Shadow Brush="Black" Opacity="0.15" Radius="10" Offset="0,3" />
                                    </Border.Shadow>
                                    <Grid ColumnDefinitions="Auto,Auto,*,Auto" RowDefinitions="Auto,Auto" ColumnSpacing="14" RowSpacing="10">

                                        <!-- Checkbox -->
                                        <CheckBox Grid.Row="0" Grid.Column="0" Grid.RowSpan="2"
                                                  IsChecked="{Binding IsPaid}"
                                                  Color="{StaticResource Success}"
                                                  CheckedChanged="OnExpenseCheckedChanged"
                                                  VerticalOptions="Center"
                                                  Scale="1.2" />

                                        <!-- Icon -->
                                        <Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="2"
                                                BackgroundColor="{StaticResource Primary}"
                                                StrokeThickness="0"
                                                StrokeShape="RoundRectangle 14"
                                                Padding="0"
                                                WidthRequest="52"
                                                HeightRequest="52"
                                                VerticalOptions="Center">
                                            <Border.Shadow>
                                                <Shadow Brush="{StaticResource Primary}" Opacity="0.25" Radius="6" Offset="0,2" />
                                            </Border.Shadow>
                                            <Label Text="ðŸ’³"
                                                   FontSize="26"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center" />
                                        </Border>

                                        <!-- Name and Amount -->
                                        <Grid Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="2" ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                            <Label Grid.Column="0"
                                                   Text="{Binding Name}"
                                                   TextColor="{StaticResource TextPrimary}"
                                                   FontSize="17"
                                                   FontAttributes="Bold"
                                                   VerticalOptions="Center"
                                                   LineBreakMode="TailTruncation" />

                                            <Label Grid.Column="1"
                                                   Text="{Binding Amount, StringFormat='â‚¬ {0:N2}'}"
                                                   TextColor="{StaticResource Primary}"
                                                   FontSize="17"
                                                   FontAttributes="Bold"
                                                   VerticalOptions="Center" />
                                        </Grid>

                                        <!-- Description and Day -->
                                        <HorizontalStackLayout Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2" Spacing="12">
                                            <Label Text="{Binding Description}"
                                                   TextColor="{StaticResource TextSecondary}"
                                                   FontSize="14"
                                                   Opacity="0.9"
                                                   LineBreakMode="TailTruncation"
                                                   VerticalOptions="Center"
                                                   HorizontalOptions="StartAndExpand" />

                                            <Border BackgroundColor="#1E293B"
                                                    StrokeThickness="0"
                                                    StrokeShape="RoundRectangle 8"
                                                    Padding="8,4"
                                                    VerticalOptions="Center">
                                                <HorizontalStackLayout Spacing="4">
                                                    <Label Text="ðŸ“…"
                                                           FontSize="12"
                                                           VerticalOptions="Center" />
                                                    <Label Text="{Binding DayOfMonth, StringFormat='Dag {0}'}"
                                                           TextColor="{StaticResource TextSecondary}"
                                                           FontSize="12"
                                                           VerticalOptions="Center" />
                                                </HorizontalStackLayout>
                                            </Border>
                                        </HorizontalStackLayout>

                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- One-Time Expenses Section -->
                <VerticalStackLayout x:Name="OneTimeExpensesSection" Spacing="12" Margin="0,24,0,0">
                    <Grid ColumnDefinitions="*,Auto" Margin="4,0,0,8">
                        <HorizontalStackLayout Grid.Column="0" Spacing="8" VerticalOptions="Center">
                            <Label Text="ðŸ›’"
                                   FontSize="24"
                                   VerticalOptions="Center" />
                            <Label Text="Eenmalige Uitgaven"
                                   TextColor="{StaticResource TextPrimary}"
                                   FontSize="22"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>

                        <Border Grid.Column="1"
                                BackgroundColor="{StaticResource Primary}"
                                StrokeThickness="0"
                                StrokeShape="RoundRectangle 22"
                                WidthRequest="44"
                                HeightRequest="44">
                            <Border.Shadow>
                                <Shadow Brush="{StaticResource Primary}" Opacity="0.4" Radius="10" Offset="0,4" />
                            </Border.Shadow>
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Tapped="OnAddOneTimeExpenseClicked" />
                            </Border.GestureRecognizers>
                            <Label Text="+"
                                   TextColor="White"
                                   FontSize="28"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   Margin="0,-2,0,0" />
                        </Border>
                    </Grid>

                    <CollectionView x:Name="OneTimeExpensesCollection" SelectionMode="None" IsVisible="False">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="local:OneTimeExpenseItem">
                                <Border BackgroundColor="{StaticResource Surface}"
                                        StrokeThickness="0"
                                        StrokeShape="RoundRectangle 18"
                                        Padding="18"
                                        Margin="0,0,0,12">
                                    <Border.Shadow>
                                        <Shadow Brush="Black" Opacity="0.15" Radius="10" Offset="0,3" />
                                    </Border.Shadow>
                                    <Grid ColumnDefinitions="Auto,Auto,*,Auto" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="14" RowSpacing="10">

                                        <!-- Checkbox -->
                                        <CheckBox Grid.Row="0" Grid.Column="0" Grid.RowSpan="3"
                                                  IsChecked="{Binding IsPaid}"
                                                  Color="{StaticResource Success}"
                                                  CheckedChanged="OnOneTimeExpenseCheckedChanged"
                                                  VerticalOptions="Center"
                                                  Scale="1.2" />

                                        <!-- Icon -->
                                        <Border Grid.Row="0" Grid.Column="1" Grid.RowSpan="3"
                                                BackgroundColor="{StaticResource Warning}"
                                                StrokeThickness="0"
                                                StrokeShape="RoundRectangle 14"
                                                Padding="0"
                                                WidthRequest="52"
                                                HeightRequest="52"
                                                VerticalOptions="Center">
                                            <Border.Shadow>
                                                <Shadow Brush="{StaticResource Warning}" Opacity="0.25" Radius="6" Offset="0,2" />
                                            </Border.Shadow>
                                            <Label Text="ðŸ›’"
                                                   FontSize="26"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center" />
                                        </Border>

                                        <!-- Name and Amount -->
                                        <Grid Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="2" ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                            <Label Grid.Column="0"
                                                   Text="{Binding Name}"
                                                   TextColor="{StaticResource TextPrimary}"
                                                   FontSize="17"
                                                   FontAttributes="Bold"
                                                   VerticalOptions="Center"
                                                   LineBreakMode="TailTruncation" />

                                            <Label Grid.Column="1"
                                                   Text="{Binding Amount, StringFormat='â‚¬ {0:N2}'}"
                                                   TextColor="{StaticResource Warning}"
                                                   FontSize="17"
                                                   FontAttributes="Bold"
                                                   VerticalOptions="Center" />
                                        </Grid>

                                        <!-- Description -->
                                        <Label Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2"
                                               Text="{Binding Description}"
                                               TextColor="{StaticResource TextSecondary}"
                                               FontSize="14"
                                               Opacity="0.9"
                                               LineBreakMode="TailTruncation"
                                               VerticalOptions="Center"
                                               IsVisible="{Binding HasDescription}" />

                                        <!-- Date and Actions -->
                                        <Grid Grid.Row="2" Grid.Column="2" Grid.ColumnSpan="2" ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                            <Border Grid.Column="0"
                                                    BackgroundColor="#1E293B"
                                                    StrokeThickness="0"
                                                    StrokeShape="RoundRectangle 8"
                                                    Padding="8,4"
                                                    VerticalOptions="Center"
                                                    HorizontalOptions="Start">
                                                <HorizontalStackLayout Spacing="4">
                                                    <Label Text="ðŸ“…"
                                                           FontSize="12"
                                                           VerticalOptions="Center" />
                                                    <Label Text="{Binding Date, StringFormat='{0:dd-MM-yyyy}'}"
                                                           TextColor="{StaticResource TextSecondary}"
                                                           FontSize="12"
                                                           VerticalOptions="Center" />
                                                </HorizontalStackLayout>
                                            </Border>

                                            <HorizontalStackLayout Grid.Column="1" Spacing="8">
                                                <Border BackgroundColor="{StaticResource Primary}"
                                                        StrokeThickness="0"
                                                        StrokeShape="RoundRectangle 10"
                                                        Padding="10">
                                                    <Border.GestureRecognizers>
                                                        <TapGestureRecognizer Tapped="OnEditOneTimeExpenseClicked" CommandParameter="{Binding .}" />
                                                    </Border.GestureRecognizers>
                                                    <Label Text="âœï¸"
                                                           FontSize="16"
                                                           VerticalOptions="Center"
                                                           HorizontalOptions="Center" />
                                                </Border>

                                                <Border BackgroundColor="{StaticResource Error}"
                                                        StrokeThickness="0"
                                                        StrokeShape="RoundRectangle 10"
                                                        Padding="10">
                                                    <Border.GestureRecognizers>
                                                        <TapGestureRecognizer Tapped="OnDeleteOneTimeExpenseClicked" CommandParameter="{Binding .}" />
                                                    </Border.GestureRecognizers>
                                                    <Label Text="ðŸ—‘ï¸"
                                                           FontSize="16"
                                                           VerticalOptions="Center"
                                                           HorizontalOptions="Center" />
                                                </Border>
                                            </HorizontalStackLayout>
                                        </Grid>

                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

    </Grid>

</ContentPage>
